@startuml sequence_compra
actor Cliente
participant "Frontend" as FE
participant Carrinho
participant Pedido
participant Pagamento
participant SistemaKeys

Cliente -> FE: Adiciona jogo ao carrinho
FE -> Carrinho: adicionarItem(jogoId, quantidade)
Carrinho -> FE: OK

Cliente -> FE: Finalizar compra
FE -> Carrinho: calcularSubtotal()
Carrinho -> FE: subtotal

FE -> Cliente: Mostrar resumo\n+ opções pagamento
Cliente -> FE: Seleciona Pix
FE -> Pedido: converterParaPedido(carrinhoId, metodoPagamento)
Pedido -> SistemaKeys: reservarKeys(itens)
SistemaKeys -> Pedido: keysReservadas
Pedido -> Pagamento: processar(total)
Pagamento -> Pedido: pagamentoAprovado
Pedido -> FE: pedidoCriado(pedidoId)
FE -> Cliente: Confirmação + chaves por email
Pedido -> SistemaKeys: marcarKeysComoVendidas(keys)
@enduml